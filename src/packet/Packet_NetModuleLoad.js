// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Core__Option = require("@rescript/core/src/Core__Option.js");
var PacketType$TerrariaPacket = require("../PacketType.js");
var CreativePowers$TerrariaPacket = require("../CreativePowers.js");
var ErrorAwarePacketReader$TerrariaPacket = require("../ErrorAwarePacketReader.js");
var ErrorAwarePacketWriter$TerrariaPacket = require("../ErrorAwarePacketWriter.js");
var Packetreader = require("@popstarfreas/packetfactory/packetreader").default;

function pylonActionToInt(pylonAction) {
  switch (pylonAction) {
    case "Added" :
        return 0;
    case "Removed" :
        return 1;
    case "RequestTeleport" :
        return 2;
    
  }
}

function powerLevelToInt(powerLevel) {
  switch (powerLevel) {
    case "LockedForEveryone" :
        return 0;
    case "CanBeChangedByHostAlone" :
        return 1;
    case "CanBeChangedByEveryone" :
        return 2;
    
  }
}

function fromInt(n) {
  switch (n) {
    case 0 :
        return "Liquid";
    case 1 :
        return "Text";
    case 2 :
        return "Ping";
    case 3 :
        return "Ambience";
    case 4 :
        return "Bestiary";
    case 5 :
        return "CreativeUnlocks";
    case 6 :
        return "CreativePower";
    case 7 :
        return "CreativeUnlocksPlayerReport";
    case 8 :
        return "TeleportPylon";
    case 9 :
        return "Particles";
    case 10 :
        return "CreativePowerPermissions";
    default:
      return ;
  }
}

function toInt(self) {
  switch (self) {
    case "Liquid" :
        return 0;
    case "Text" :
        return 1;
    case "Ping" :
        return 2;
    case "Ambience" :
        return 3;
    case "Bestiary" :
        return 4;
    case "CreativeUnlocks" :
        return 5;
    case "CreativePower" :
        return 6;
    case "CreativeUnlocksPlayerReport" :
        return 7;
    case "TeleportPylon" :
        return 8;
    case "Particles" :
        return 9;
    case "CreativePowerPermissions" :
        return 10;
    
  }
}

var NetModuleType = {
  fromInt: fromInt,
  toInt: toInt
};

function toBuffer(self) {
  switch (self.TAG) {
    case "Liquid" :
        var liquid = self._0;
        var writer = ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 0, "moduleType"), liquid.changes.length, "changesCount");
        liquid.changes.forEach(function (change) {
              ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packInt16(ErrorAwarePacketWriter$TerrariaPacket.packInt16(writer, change.y, "y"), change.x, "x"), change.amount, "amount"), change.liquidType, "liquidType");
            });
        return ErrorAwarePacketWriter$TerrariaPacket.data(writer);
    case "ClientText" :
        var commandId = self._0;
        var message = self._1;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packString(ErrorAwarePacketWriter$TerrariaPacket.packString(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 1, "moduleType"), commandId, "commandId"), message, "message"));
    case "ServerText" :
        var playerId = self._0;
        var networkText = self._1;
        var color = self._2;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packNetworkText(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 1, "moduleType"), playerId, "playerId"), networkText, "networkText"), color, "color"));
    case "Ping" :
        var ping = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 2, "moduleType"), ping.x, "x"), ping.y, "y"));
    case "Ambience" :
        var ambience = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packInt32(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 3, "moduleType"), ambience.playerId, "playerId"), ambience.seed, "seed"), ambience.skyEntityType, "skyEntityType"));
    case "Bestiary" :
        var bestiary = self._0;
        var writer$1 = ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 4, "moduleType");
        var _count = bestiary.unlockType;
        var tmp;
        tmp = typeof _count !== "object" ? (
            _count === "Sight" ? ErrorAwarePacketWriter$TerrariaPacket.packByte(writer$1, 1, "unlockTypeByte") : ErrorAwarePacketWriter$TerrariaPacket.packByte(writer$1, 2, "unlockTypeByte")
          ) : ErrorAwarePacketWriter$TerrariaPacket.packByte(writer$1, 0, "unlockTypeByte");
        ErrorAwarePacketWriter$TerrariaPacket.packInt16(tmp, bestiary.npcId, "npcId");
        var count = bestiary.unlockType;
        var tmp$1;
        tmp$1 = typeof count !== "object" ? writer$1 : ErrorAwarePacketWriter$TerrariaPacket.packUInt16(writer$1, count._0, "killCount");
        return ErrorAwarePacketWriter$TerrariaPacket.data(tmp$1);
    case "CreativeUnlocks" :
        var creativeUnlock = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.packInt16(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 5, "moduleType"), creativeUnlock.itemId, "itemId"), creativeUnlock.researchedCount, "researchedCount"));
    case "CreativePower" :
        var creativePower = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(CreativePowers$TerrariaPacket.pack(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 6, "moduleType"), creativePower));
    case "CreativeUnlocksPlayerReport" :
        var unlockReport = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 7, "moduleType"), unlockReport.itemId, "itemId"), unlockReport.researchedCount, "researchedCount"));
    case "TeleportPylon" :
        var teleportPylon = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packInt16(ErrorAwarePacketWriter$TerrariaPacket.packInt16(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 8, "moduleType"), pylonActionToInt(teleportPylon.pylonAction), "pylonAction"), teleportPylon.x, "x"), teleportPylon.y, "y"), teleportPylon.pylonType, "pylonType"));
    case "Particles" :
        var particle = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packInt32(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 9, "moduleType"), particle.particleType, "particleType"), particle.x, "x"), particle.y, "y"), particle.vx, "vx"), particle.vy, "vy"), particle.shaderIndex, "shaderIndex"), particle.invokedByPlayer, "invokedByPlayer"));
    case "CreativePowerPermissions" :
        var creativePowerPermission = self._0;
        return ErrorAwarePacketWriter$TerrariaPacket.data(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packUInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("NetModuleLoad")), 10, "moduleType"), creativePowerPermission.powerType, "powerType"), powerLevelToInt(creativePowerPermission.powerLevel), "powerLevel"));
    
  }
}

function parse(payload, fromServer) {
  var reader = new Packetreader(payload);
  var moduleType = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "moduleType");
  var match = fromInt(moduleType);
  if (match === undefined) {
    return ;
  }
  switch (match) {
    case "Liquid" :
        var changesCount = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "changesCount");
        var changes = [];
        for(var _for = 0; _for < changesCount; ++_for){
          var y = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "y");
          var x = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "x");
          var amount = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "amount");
          var liquidType = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "liquidType");
          changes.push({
                x: x,
                y: y,
                amount: amount,
                liquidType: liquidType
              });
        }
        return {
                TAG: "Liquid",
                _0: {
                  changes: changes
                }
              };
    case "Text" :
        if (fromServer) {
          var playerId = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "playerId");
          var message = ErrorAwarePacketReader$TerrariaPacket.readNetworkText(reader, "message");
          var color = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "color");
          return {
                  TAG: "ServerText",
                  _0: playerId,
                  _1: message,
                  _2: color
                };
        }
        var commandId = ErrorAwarePacketReader$TerrariaPacket.readString(reader, "commandId");
        var message$1 = ErrorAwarePacketReader$TerrariaPacket.readString(reader, "message");
        return {
                TAG: "ClientText",
                _0: commandId,
                _1: message$1
              };
    case "Ping" :
        var x$1 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "x");
        var y$1 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "y");
        return {
                TAG: "Ping",
                _0: {
                  x: x$1,
                  y: y$1
                }
              };
    case "Ambience" :
        var playerId$1 = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "playerId");
        var seed = ErrorAwarePacketReader$TerrariaPacket.readInt32(reader, "seed");
        var skyEntityType = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "skyEntityType");
        return {
                TAG: "Ambience",
                _0: {
                  playerId: playerId$1,
                  seed: seed,
                  skyEntityType: skyEntityType
                }
              };
    case "Bestiary" :
        var rawBestiaryUnlockType = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "rawBestiaryUnlockType");
        var npcId = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "npcId");
        var bestiaryUnlockType;
        switch (rawBestiaryUnlockType) {
          case 0 :
              bestiaryUnlockType = {
                TAG: "Kill",
                _0: ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "killCount")
              };
              break;
          case 1 :
              bestiaryUnlockType = "Sight";
              break;
          case 2 :
              bestiaryUnlockType = "Chat";
              break;
          default:
            bestiaryUnlockType = undefined;
        }
        if (bestiaryUnlockType !== undefined) {
          return {
                  TAG: "Bestiary",
                  _0: {
                    unlockType: bestiaryUnlockType,
                    npcId: npcId
                  }
                };
        } else {
          return ;
        }
    case "CreativeUnlocks" :
        var itemId = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "itemId");
        var researchedCount = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "researchedCount");
        return {
                TAG: "CreativeUnlocks",
                _0: {
                  itemId: itemId,
                  researchedCount: researchedCount
                }
              };
    case "CreativePower" :
        return Core__Option.map(CreativePowers$TerrariaPacket.parse(reader), (function (p) {
                      return {
                              TAG: "CreativePower",
                              _0: p
                            };
                    }));
    case "CreativeUnlocksPlayerReport" :
        ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "unknownByte");
        var itemId$1 = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "itemId");
        var researchedCount$1 = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "researchedCount");
        return {
                TAG: "CreativeUnlocksPlayerReport",
                _0: {
                  itemId: itemId$1,
                  researchedCount: researchedCount$1
                }
              };
    case "TeleportPylon" :
        var rawPylonAction = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "rawPylonAction");
        var x$2 = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "x");
        var y$2 = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "y");
        var pylonType = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "pylonType");
        var pylonAction;
        switch (rawPylonAction) {
          case 0 :
              pylonAction = "Added";
              break;
          case 1 :
              pylonAction = "Removed";
              break;
          case 2 :
              pylonAction = "RequestTeleport";
              break;
          default:
            pylonAction = undefined;
        }
        if (pylonAction !== undefined) {
          return {
                  TAG: "TeleportPylon",
                  _0: {
                    pylonAction: pylonAction,
                    x: x$2,
                    y: y$2,
                    pylonType: pylonType
                  }
                };
        } else {
          return ;
        }
    case "Particles" :
        var particleType = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "particleType");
        var x$3 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "x");
        var y$3 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "y");
        var vx = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "vx");
        var vy = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "vy");
        var shaderIndex = ErrorAwarePacketReader$TerrariaPacket.readInt32(reader, "shaderIndex");
        var invokedByPlayer = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "invokedByPlayer");
        return {
                TAG: "Particles",
                _0: {
                  particleType: particleType,
                  x: x$3,
                  y: y$3,
                  vx: vx,
                  vy: vy,
                  shaderIndex: shaderIndex,
                  invokedByPlayer: invokedByPlayer
                }
              };
    case "CreativePowerPermissions" :
        ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "unknownByte");
        var powerType = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "powerType");
        var rawPowerLevel = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "rawPowerLevel");
        var powerLevel;
        switch (rawPowerLevel) {
          case 0 :
              powerLevel = "LockedForEveryone";
              break;
          case 1 :
              powerLevel = "CanBeChangedByHostAlone";
              break;
          case 2 :
              powerLevel = "CanBeChangedByEveryone";
              break;
          default:
            powerLevel = undefined;
        }
        if (powerLevel !== undefined) {
          return {
                  TAG: "CreativePowerPermissions",
                  _0: {
                    powerType: powerType,
                    powerLevel: powerLevel
                  }
                };
        } else {
          return ;
        }
    
  }
}

exports.NetModuleType = NetModuleType;
exports.toBuffer = toBuffer;
exports.parse = parse;
/* CreativePowers-TerrariaPacket Not a pure module */
