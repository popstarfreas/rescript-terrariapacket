// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

let Stdlib_Option = require("@rescript/runtime/lib/js/Stdlib_Option.js");
let Primitive_option = require("@rescript/runtime/lib/js/Primitive_option.js");
let BitFlags$TerrariaPacket = require("../BitFlags.js");
let PacketType$TerrariaPacket = require("../PacketType.js");
let ErrorAwarePacketReader$TerrariaPacket = require("../ErrorAwarePacketReader.js");
let ErrorAwarePacketWriter$TerrariaPacket = require("../ErrorAwarePacketWriter.js");
let Packetreader = require("@popstarfreas/packetfactory/packetreader").default;

function parse(payload) {
  let reader = new Packetreader(payload);
  let e = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "projectileId");
  if (e.TAG !== "Ok") {
    return e;
  }
  let e$1 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "x");
  if (e$1.TAG !== "Ok") {
    return e$1;
  }
  let e$2 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "y");
  if (e$2.TAG !== "Ok") {
    return e$2;
  }
  let e$3 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "vx");
  if (e$3.TAG !== "Ok") {
    return e$3;
  }
  let e$4 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "vy");
  if (e$4.TAG !== "Ok") {
    return e$4;
  }
  let e$5 = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "owner");
  if (e$5.TAG !== "Ok") {
    return e$5;
  }
  let e$6 = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "projectileType");
  if (e$6.TAG !== "Ok") {
    return e$6;
  }
  let e$7 = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "flags");
  if (e$7.TAG !== "Ok") {
    return e$7;
  }
  let flags = BitFlags$TerrariaPacket.fromByte(e$7._0);
  let e$8;
  if (BitFlags$TerrariaPacket.flag3(flags)) {
    let e$9 = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "flags2");
    e$8 = e$9.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: Primitive_option.some(BitFlags$TerrariaPacket.fromByte(e$9._0))
      }) : e$9;
  } else {
    e$8 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$8.TAG !== "Ok") {
    return e$8;
  }
  let flags2 = e$8._0;
  let e$10;
  if (BitFlags$TerrariaPacket.flag1(flags)) {
    let e$11 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "ai0");
    e$10 = e$11.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$11._0
      }) : e$11;
  } else {
    e$10 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$10.TAG !== "Ok") {
    return e$10;
  }
  let e$12;
  if (BitFlags$TerrariaPacket.flag2(flags)) {
    let e$13 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "ai1");
    e$12 = e$13.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$13._0
      }) : e$13;
  } else {
    e$12 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$12.TAG !== "Ok") {
    return e$12;
  }
  let e$14;
  if (BitFlags$TerrariaPacket.flag4(flags)) {
    let e$15 = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, "bannerIdToRespondTo");
    e$14 = e$15.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$15._0
      }) : e$15;
  } else {
    e$14 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$14.TAG !== "Ok") {
    return e$14;
  }
  let e$16;
  if (BitFlags$TerrariaPacket.flag5(flags)) {
    let e$17 = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "damage");
    e$16 = e$17.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$17._0
      }) : e$17;
  } else {
    e$16 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$16.TAG !== "Ok") {
    return e$16;
  }
  let e$18;
  if (BitFlags$TerrariaPacket.flag6(flags)) {
    let e$19 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "knockback");
    e$18 = e$19.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$19._0
      }) : e$19;
  } else {
    e$18 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$18.TAG !== "Ok") {
    return e$18;
  }
  let e$20;
  if (BitFlags$TerrariaPacket.flag7(flags)) {
    let e$21 = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "originalDamage");
    e$20 = e$21.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$21._0
      }) : e$21;
  } else {
    e$20 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$20.TAG !== "Ok") {
    return e$20;
  }
  let e$22;
  if (BitFlags$TerrariaPacket.flag8(flags)) {
    let e$23 = ErrorAwarePacketReader$TerrariaPacket.readInt16(reader, "projectileUuid");
    e$22 = e$23.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$23._0
      }) : e$23;
  } else {
    e$22 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$22.TAG !== "Ok") {
    return e$22;
  }
  let e$24;
  if (flags2 !== undefined && BitFlags$TerrariaPacket.flag1(Primitive_option.valFromOption(flags2))) {
    let e$25 = ErrorAwarePacketReader$TerrariaPacket.readSingle(reader, "ai2");
    e$24 = e$25.TAG === "Ok" ? ({
        TAG: "Ok",
        _0: e$25._0
      }) : e$25;
  } else {
    e$24 = {
      TAG: "Ok",
      _0: undefined
    };
  }
  if (e$24.TAG === "Ok") {
    return {
      TAG: "Ok",
      _0: {
        projectileId: e._0,
        x: e$1._0,
        y: e$2._0,
        vx: e$3._0,
        vy: e$4._0,
        owner: e$5._0,
        projectileType: e$6._0,
        ai: [
          e$10._0,
          e$12._0,
          e$24._0
        ],
        bannerIdToRespondTo: e$14._0,
        damage: e$16._0,
        knockback: e$18._0,
        originalDamage: e$20._0,
        projectileUuid: e$22._0
      }
    };
  } else {
    return e$24;
  }
}

function packOptionalData(writer, self) {
  let match = self.ai;
  let ai2 = match[2];
  let ai1 = match[1];
  let ai0 = match[0];
  let bitFlags2 = BitFlags$TerrariaPacket.fromFlags(Stdlib_Option.isSome(ai2), false, false, false, false, false, false, false);
  let bannerIdToRespondTo = self.bannerIdToRespondTo;
  let bitFlags = BitFlags$TerrariaPacket.fromFlags(Stdlib_Option.isSome(ai0), Stdlib_Option.isSome(ai1), BitFlags$TerrariaPacket.toByte(bitFlags2) !== 0, bannerIdToRespondTo !== undefined ? bannerIdToRespondTo !== 0 : false, Stdlib_Option.isSome(self.damage), Stdlib_Option.isSome(self.knockback), Stdlib_Option.isSome(self.originalDamage), Stdlib_Option.isSome(self.projectileUuid));
  ErrorAwarePacketWriter$TerrariaPacket.packByte(writer, BitFlags$TerrariaPacket.toByte(bitFlags), "flags");
  if (BitFlags$TerrariaPacket.flag3(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packByte(writer, BitFlags$TerrariaPacket.toByte(bitFlags2), "flags2");
  }
  if (BitFlags$TerrariaPacket.flag1(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packSingle(writer, ai0, "ai0");
  }
  if (BitFlags$TerrariaPacket.flag2(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packSingle(writer, ai1, "ai1");
  }
  if (BitFlags$TerrariaPacket.flag4(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packUInt16(writer, self.bannerIdToRespondTo, "bannerIdToRespondTo");
  }
  if (BitFlags$TerrariaPacket.flag5(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packInt16(writer, self.damage, "damage");
  }
  if (BitFlags$TerrariaPacket.flag6(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packSingle(writer, self.knockback, "knockback");
  }
  if (BitFlags$TerrariaPacket.flag7(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packInt16(writer, self.originalDamage, "originalDamage");
  }
  if (BitFlags$TerrariaPacket.flag8(bitFlags)) {
    ErrorAwarePacketWriter$TerrariaPacket.packInt16(writer, self.projectileUuid, "projectileUuid");
  }
  if (BitFlags$TerrariaPacket.flag1(bitFlags2)) {
    ErrorAwarePacketWriter$TerrariaPacket.packSingle(writer, ai2, "ai2");
  }
  return writer;
}

function toBuffer(self) {
  return ErrorAwarePacketWriter$TerrariaPacket.data(packOptionalData(ErrorAwarePacketWriter$TerrariaPacket.packInt16(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packSingle(ErrorAwarePacketWriter$TerrariaPacket.packInt16(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("ProjectileSync")), self.projectileId, "projectileId"), self.x, "x"), self.y, "y"), self.vx, "vx"), self.vy, "vy"), self.owner, "owner"), self.projectileType, "projectileType"), self));
}

exports.parse = parse;
exports.toBuffer = toBuffer;
/* ErrorAwarePacketWriter-TerrariaPacket Not a pure module */
