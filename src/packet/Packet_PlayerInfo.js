// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var BitFlags$TerrariaPacket = require("../BitFlags.js");
var PacketType$TerrariaPacket = require("../PacketType.js");
var ErrorAwarePacketReader$TerrariaPacket = require("../ErrorAwarePacketReader.js");
var ErrorAwarePacketWriter$TerrariaPacket = require("../ErrorAwarePacketWriter.js");
var Packetreader = require("@popstarfreas/packetfactory/packetreader").default;

function getDifficulty(difficultyFlags) {
  if (BitFlags$TerrariaPacket.flag2(difficultyFlags)) {
    return "Hardcore";
  } else if (BitFlags$TerrariaPacket.flag1(difficultyFlags)) {
    return "Mediumcore";
  } else {
    return "Softcore";
  }
}

function parse(payload) {
  var reader = new Packetreader(payload);
  var playerId = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "playerId");
  var skinVariant = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "skinVariant");
  var hair = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "hair");
  var name = ErrorAwarePacketReader$TerrariaPacket.readString(reader, "name");
  var hairDye = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "hairDye");
  var hideVisuals = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "hideVisuals");
  var hideVisuals2 = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "hideVisuals2");
  var hideMisc = ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "hideMisc");
  var hairColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "hairColor");
  var skinColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "skinColor");
  var eyeColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "eyeColor");
  var shirtColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "shirtColor");
  var underShirtColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "underShirtColor");
  var pantsColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "pantsColor");
  var shoeColor = ErrorAwarePacketReader$TerrariaPacket.readColor(reader, "shoeColor");
  var difficultyFlags = BitFlags$TerrariaPacket.fromByte(ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "difficultyFlags"));
  var torchFlags = BitFlags$TerrariaPacket.fromByte(ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "torchFlags"));
  var difficulty = getDifficulty(difficultyFlags);
  var extraAccessory = BitFlags$TerrariaPacket.flag3(difficultyFlags);
  var mode = BitFlags$TerrariaPacket.flag4(difficultyFlags) ? "Journey" : "Classic";
  var usingBiomeTorches = BitFlags$TerrariaPacket.flag1(torchFlags);
  var happyFunTorchTime = BitFlags$TerrariaPacket.flag2(torchFlags);
  var unlockedBiomeTorches = BitFlags$TerrariaPacket.flag3(torchFlags);
  var unlockedSuperCart = BitFlags$TerrariaPacket.flag4(torchFlags);
  var enabledSuperCart = BitFlags$TerrariaPacket.flag5(torchFlags);
  var usedFlags = BitFlags$TerrariaPacket.fromByte(ErrorAwarePacketReader$TerrariaPacket.readByte(reader, "usedFlags"));
  var usedAegisCrystal = BitFlags$TerrariaPacket.flag1(usedFlags);
  var usedAegisFruit = BitFlags$TerrariaPacket.flag2(usedFlags);
  var usedArcaneCrystal = BitFlags$TerrariaPacket.flag3(usedFlags);
  var usedGalaxyPearl = BitFlags$TerrariaPacket.flag4(usedFlags);
  var usedGummyWorm = BitFlags$TerrariaPacket.flag5(usedFlags);
  var usedAmbrosia = BitFlags$TerrariaPacket.flag6(usedFlags);
  var ateArtisanBread = BitFlags$TerrariaPacket.flag7(usedFlags);
  return {
          playerId: playerId,
          skinVariant: skinVariant,
          hair: hair,
          name: name,
          hairDye: hairDye,
          hideVisuals: hideVisuals,
          hideVisuals2: hideVisuals2,
          hideMisc: hideMisc,
          hairColor: hairColor,
          skinColor: skinColor,
          eyeColor: eyeColor,
          shirtColor: shirtColor,
          underShirtColor: underShirtColor,
          pantsColor: pantsColor,
          shoeColor: shoeColor,
          difficulty: difficulty,
          mode: mode,
          extraAccessory: extraAccessory,
          usingBiomeTorches: usingBiomeTorches,
          unlockedBiomeTorches: unlockedBiomeTorches,
          happyFunTorchTime: happyFunTorchTime,
          unlockedSuperCart: unlockedSuperCart,
          enabledSuperCart: enabledSuperCart,
          usedAegisCrystal: usedAegisCrystal,
          usedAegisFruit: usedAegisFruit,
          usedArcaneCrystal: usedArcaneCrystal,
          usedGalaxyPearl: usedGalaxyPearl,
          usedGummyWorm: usedGummyWorm,
          usedAmbrosia: usedAmbrosia,
          ateArtisanBread: ateArtisanBread
        };
}

function packDifficultyFlags(writer, difficulty, extraAccessory, mode) {
  var $$byte = 0;
  var tmp;
  switch (difficulty) {
    case "Softcore" :
        tmp = 0;
        break;
    case "Mediumcore" :
        tmp = 1;
        break;
    case "Hardcore" :
        tmp = 2;
        break;
    
  }
  $$byte = $$byte | tmp;
  $$byte = $$byte | (
    extraAccessory ? 4 : 0
  );
  $$byte = $$byte | (
    mode === "Journey" ? 8 : 0
  );
  return ErrorAwarePacketWriter$TerrariaPacket.packByte(writer, $$byte, "difficultyFlags");
}

function packTorchFlags(writer, usingBiomeTorches, happyFunTorchTime, unlockedBiomeTorches, unlockedSuperCart, enabledSuperCart) {
  var $$byte = 0;
  $$byte = $$byte | (
    usingBiomeTorches ? 1 : 0
  );
  $$byte = $$byte | (
    happyFunTorchTime ? 2 : 0
  );
  $$byte = $$byte | (
    unlockedBiomeTorches ? 4 : 0
  );
  $$byte = $$byte | (
    unlockedSuperCart ? 8 : 0
  );
  $$byte = $$byte | (
    enabledSuperCart ? 16 : 0
  );
  return ErrorAwarePacketWriter$TerrariaPacket.packByte(writer, $$byte, "torchFlags");
}

function packUsedFlags(writer, usedAegisCrystal, usedAegisFruit, usedArcaneCrystal, usedGalaxyPearl, usedGummyWorm, usedAmbrosia, ateArtisanBread) {
  var $$byte = 0;
  $$byte = $$byte | (
    usedAegisCrystal ? 1 : 0
  );
  $$byte = $$byte | (
    usedAegisFruit ? 2 : 0
  );
  $$byte = $$byte | (
    usedArcaneCrystal ? 4 : 0
  );
  $$byte = $$byte | (
    usedGalaxyPearl ? 8 : 0
  );
  $$byte = $$byte | (
    usedGummyWorm ? 16 : 0
  );
  $$byte = $$byte | (
    usedAmbrosia ? 32 : 0
  );
  $$byte = $$byte | (
    ateArtisanBread ? 64 : 0
  );
  return ErrorAwarePacketWriter$TerrariaPacket.packByte(writer, $$byte, "usedFlags");
}

function toBuffer(self) {
  return ErrorAwarePacketWriter$TerrariaPacket.data(packUsedFlags(packTorchFlags(packDifficultyFlags(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packColor(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packString(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.packByte(ErrorAwarePacketWriter$TerrariaPacket.setType(ErrorAwarePacketWriter$TerrariaPacket.make(), PacketType$TerrariaPacket.toInt("PlayerInfo")), self.playerId, "playerId"), self.skinVariant, "skinVariant"), self.hair, "hair"), self.name, "name"), self.hairDye, "hairDye"), self.hideVisuals, "hideVisuals"), self.hideVisuals2, "hideVisuals2"), self.hideMisc, "hideMisc"), self.hairColor, "hairColor"), self.skinColor, "skinColor"), self.eyeColor, "eyeColor"), self.shirtColor, "shirtColor"), self.underShirtColor, "underShirtColor"), self.pantsColor, "pantsColor"), self.shoeColor, "shoeColor"), self.difficulty, self.extraAccessory, self.mode), self.usingBiomeTorches, self.happyFunTorchTime, self.unlockedBiomeTorches, self.unlockedSuperCart, self.enabledSuperCart), self.usedAegisCrystal, self.usedAegisFruit, self.usedArcaneCrystal, self.usedGalaxyPearl, self.usedGummyWorm, self.usedAmbrosia, self.ateArtisanBread));
}

exports.parse = parse;
exports.toBuffer = toBuffer;
/* ErrorAwarePacketWriter-TerrariaPacket Not a pure module */
