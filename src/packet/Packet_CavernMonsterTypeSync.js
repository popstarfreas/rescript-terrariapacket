// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

let Stdlib_Array = require("@rescript/runtime/lib/js/Stdlib_Array.js");
let PacketType$TerrariaPacket = require("../PacketType.js");
let ManagedPacketWriter$PacketFactory = require("@popstarfreas/packetfactory/src/ManagedPacketWriter.js");
let ErrorAwarePacketReader$TerrariaPacket = require("../ErrorAwarePacketReader.js");
let Packetreader = require("@popstarfreas/packetfactory/packetreader").default;
let Packetwriter = require("@popstarfreas/packetfactory/packetwriter").default;

function parse(payload) {
  let reader = new Packetreader(payload);
  let rows = Stdlib_Array.make(2, []);
  let error;
  for (let i = 0; i <= 1; ++i) {
    if (error !== undefined) {
      let row = Stdlib_Array.make(3, 0);
      for (let j = 0; j <= 2; ++j) {
        if (error !== undefined) {
          let value = ErrorAwarePacketReader$TerrariaPacket.readUInt16(reader, `monster_` + i.toString() + `_` + j.toString());
          if (value.TAG === "Ok") {
            row[j] = value._0;
          } else {
            error = value._0;
          }
        }
      }
      rows[i] = row;
    }
  }
  let err = error;
  if (err !== undefined) {
    return {
      TAG: "Error",
      _0: err
    };
  } else {
    return {
      TAG: "Ok",
      _0: rows
    };
  }
}

let Decode = {
  readUInt16: ErrorAwarePacketReader$TerrariaPacket.readUInt16,
  parse: parse
};

function packUInt16(prim0, prim1) {
  return prim0.packUInt16(prim1);
}

function data(prim) {
  return prim.data;
}

function toBuffer(self) {
  let writer = ManagedPacketWriter$PacketFactory.setType(new Packetwriter(), PacketType$TerrariaPacket.toInt("CavernMonsterTypeSync"));
  self.forEach(row => {
    row.forEach(value => {
      writer.packUInt16(value);
    });
  });
  return writer.data;
}

let Encode = {
  packUInt16: packUInt16,
  setType: ManagedPacketWriter$PacketFactory.setType,
  data: data,
  toBuffer: toBuffer
};

exports.Decode = Decode;
exports.Encode = Encode;
exports.parse = parse;
exports.toBuffer = toBuffer;
/* @popstarfreas/packetfactory/packetreader Not a pure module */
