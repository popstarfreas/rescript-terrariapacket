// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

let BitFlags$TerrariaPacket = require("../../BitFlags.js");
let PacketType$TerrariaPacket = require("../../PacketType.js");
let ManagedPacketWriter$PacketFactory = require("@popstarfreas/packetfactory/src/ManagedPacketWriter.js");
let Packetreader = require("@popstarfreas/packetfactory/packetreader").default;
let Packetwriter = require("@popstarfreas/packetfactory/packetwriter").default;

function readByte(prim) {
  return prim.readByte();
}

function readColor(prim) {
  return prim.readColor();
}

function readString(prim) {
  return prim.readString();
}

function getDifficulty(difficultyFlags) {
  if (BitFlags$TerrariaPacket.flag2(difficultyFlags)) {
    return "Hardcore";
  } else if (BitFlags$TerrariaPacket.flag1(difficultyFlags)) {
    return "Mediumcore";
  } else {
    return "Softcore";
  }
}

function parse(payload) {
  let reader = new Packetreader(payload);
  let playerId = reader.readByte();
  let skinVariant = reader.readByte();
  let hair = reader.readByte();
  let name = reader.readString();
  let hairDye = reader.readByte();
  let hideVisuals = reader.readByte();
  let hideVisuals2 = reader.readByte();
  let hideMisc = reader.readByte();
  let hairColor = reader.readColor();
  let skinColor = reader.readColor();
  let eyeColor = reader.readColor();
  let shirtColor = reader.readColor();
  let underShirtColor = reader.readColor();
  let pantsColor = reader.readColor();
  let shoeColor = reader.readColor();
  let difficultyFlags = BitFlags$TerrariaPacket.fromByte(reader.readByte());
  let torchFlags = BitFlags$TerrariaPacket.fromByte(reader.readByte());
  let difficulty = getDifficulty(difficultyFlags);
  let extraAccessory = BitFlags$TerrariaPacket.flag3(difficultyFlags);
  let mode = BitFlags$TerrariaPacket.flag4(difficultyFlags) ? "Journey" : "Classic";
  let usingBiomeTorches = BitFlags$TerrariaPacket.flag1(torchFlags);
  let happyFunTorchTime = BitFlags$TerrariaPacket.flag2(torchFlags);
  let unlockedBiomeTorches = BitFlags$TerrariaPacket.flag3(torchFlags);
  return {
    playerId: playerId,
    skinVariant: skinVariant,
    hair: hair,
    name: name,
    hairDye: hairDye,
    hideVisuals: hideVisuals,
    hideVisuals2: hideVisuals2,
    hideMisc: hideMisc,
    hairColor: hairColor,
    skinColor: skinColor,
    eyeColor: eyeColor,
    shirtColor: shirtColor,
    underShirtColor: underShirtColor,
    pantsColor: pantsColor,
    shoeColor: shoeColor,
    difficulty: difficulty,
    mode: mode,
    extraAccessory: extraAccessory,
    usingBiomeTorches: usingBiomeTorches,
    unlockedBiomeTorches: unlockedBiomeTorches,
    happyFunTorchTime: happyFunTorchTime
  };
}

let Decode = {
  readByte: readByte,
  readColor: readColor,
  readString: readString,
  getDifficulty: getDifficulty,
  parse: parse
};

function packByte(prim0, prim1) {
  return prim0.packByte(prim1);
}

function packString(prim0, prim1) {
  return prim0.packString(prim1);
}

function packColor(prim0, prim1) {
  return prim0.packColor(prim1);
}

function data(prim) {
  return prim.data;
}

function packDifficultyFlags(writer, difficulty, extraAccessory, mode) {
  let byte = 0;
  let tmp;
  switch (difficulty) {
    case "Softcore" :
      tmp = 0;
      break;
    case "Mediumcore" :
      tmp = 1;
      break;
    case "Hardcore" :
      tmp = 2;
      break;
  }
  byte = byte | tmp;
  byte = byte | (
    extraAccessory ? 4 : 0
  );
  byte = byte | (
    mode === "Journey" ? 8 : 0
  );
  return writer.packByte(byte);
}

function packTorchFlags(writer, usingBiomeTorches, happyFunTorchTime, unlockedBiomeTorches) {
  let byte = 0;
  byte = byte | (
    usingBiomeTorches ? 1 : 0
  );
  byte = byte | (
    happyFunTorchTime ? 2 : 0
  );
  byte = byte | (
    unlockedBiomeTorches ? 4 : 0
  );
  return writer.packByte(byte);
}

function toBuffer(self) {
  return packTorchFlags(packDifficultyFlags(ManagedPacketWriter$PacketFactory.setType(new Packetwriter(), PacketType$TerrariaPacket.toInt("PlayerInfo")).packByte(self.playerId).packByte(self.skinVariant).packByte(self.hair).packString(self.name).packByte(self.hairDye).packByte(self.hideVisuals).packByte(self.hideVisuals2).packByte(self.hideMisc).packColor(self.hairColor).packColor(self.skinColor).packColor(self.eyeColor).packColor(self.shirtColor).packColor(self.underShirtColor).packColor(self.pantsColor).packColor(self.shoeColor), self.difficulty, self.extraAccessory, self.mode), self.usingBiomeTorches, self.happyFunTorchTime, self.unlockedBiomeTorches).data;
}

let Encode = {
  packByte: packByte,
  packString: packString,
  packColor: packColor,
  setType: ManagedPacketWriter$PacketFactory.setType,
  data: data,
  packDifficultyFlags: packDifficultyFlags,
  packTorchFlags: packTorchFlags,
  toBuffer: toBuffer
};

function toLatest(self) {
  return {
    playerId: self.playerId,
    skinVariant: self.skinVariant,
    hair: self.hair,
    name: self.name,
    hairDye: self.hairDye,
    hideVisuals: self.hideVisuals,
    hideVisuals2: self.hideVisuals2,
    hideMisc: self.hideMisc,
    hairColor: self.hairColor,
    skinColor: self.skinColor,
    eyeColor: self.eyeColor,
    shirtColor: self.shirtColor,
    underShirtColor: self.underShirtColor,
    pantsColor: self.pantsColor,
    shoeColor: self.shoeColor,
    difficulty: self.difficulty,
    mode: self.mode,
    extraAccessory: self.extraAccessory,
    usingBiomeTorches: self.usingBiomeTorches,
    unlockedBiomeTorches: self.unlockedBiomeTorches,
    happyFunTorchTime: self.happyFunTorchTime,
    unlockedSuperCart: false,
    enabledSuperCart: false,
    usedAegisCrystal: false,
    usedAegisFruit: false,
    usedArcaneCrystal: false,
    usedGalaxyPearl: false,
    usedGummyWorm: false,
    usedAmbrosia: false,
    ateArtisanBread: false
  };
}

function fromLatest(latest) {
  return {
    playerId: latest.playerId,
    skinVariant: latest.skinVariant,
    hair: latest.hair,
    name: latest.name,
    hairDye: latest.hairDye,
    hideVisuals: latest.hideVisuals,
    hideVisuals2: latest.hideVisuals2,
    hideMisc: latest.hideMisc,
    hairColor: latest.hairColor,
    skinColor: latest.skinColor,
    eyeColor: latest.eyeColor,
    shirtColor: latest.shirtColor,
    underShirtColor: latest.underShirtColor,
    pantsColor: latest.pantsColor,
    shoeColor: latest.shoeColor,
    difficulty: latest.difficulty,
    mode: latest.mode,
    extraAccessory: latest.extraAccessory,
    usingBiomeTorches: latest.usingBiomeTorches,
    unlockedBiomeTorches: latest.unlockedBiomeTorches,
    happyFunTorchTime: latest.happyFunTorchTime
  };
}

let Color;

exports.Color = Color;
exports.Decode = Decode;
exports.Encode = Encode;
exports.parse = parse;
exports.toBuffer = toBuffer;
exports.toLatest = toLatest;
exports.fromLatest = fromLatest;
/* @popstarfreas/packetfactory/packetreader Not a pure module */
