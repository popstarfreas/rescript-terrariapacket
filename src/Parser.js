// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

let Stdlib_Lazy = require("@rescript/runtime/lib/js/Stdlib_Lazy.js");
let Stdlib_Result = require("@rescript/runtime/lib/js/Stdlib_Result.js");
let Primitive_exceptions = require("@rescript/runtime/lib/js/Primitive_exceptions.js");
let PacketType$TerrariaPacket = require("./PacketType.js");
let Packet_Status$TerrariaPacket = require("./packet/Packet_Status.js");
let Packet_TimeSet$TerrariaPacket = require("./packet/Packet_TimeSet.js");
let Packet_NpcCatch$TerrariaPacket = require("./packet/Packet_NpcCatch.js");
let Packet_Teleport$TerrariaPacket = require("./packet/Packet_Teleport.js");
let Packet_ChestItem$TerrariaPacket = require("./packet/Packet_ChestItem.js");
let Packet_ItemOwner$TerrariaPacket = require("./packet/Packet_ItemOwner.js");
let Packet_NpcTamper$TerrariaPacket = require("./packet/Packet_NpcTamper.js");
let Packet_NpcUpdate$TerrariaPacket = require("./packet/Packet_NpcUpdate.js");
let Packet_PvpToggle$TerrariaPacket = require("./packet/Packet_PvpToggle.js");
let Packet_TilePaint$TerrariaPacket = require("./packet/Packet_TilePaint.js");
let Packet_WallPaint$TerrariaPacket = require("./packet/Packet_WallPaint.js");
let Packet_WorldInfo$TerrariaPacket = require("./packet/Packet_WorldInfo.js");
let Packet_ChestPlace$TerrariaPacket = require("./packet/Packet_ChestPlace.js");
let Packet_ClientUuid$TerrariaPacket = require("./packet/Packet_ClientUuid.js");
let Packet_Disconnect$TerrariaPacket = require("./packet/Packet_Disconnect.js");
let Packet_HealEffect$TerrariaPacket = require("./packet/Packet_HealEffect.js");
let Packet_ManaEffect$TerrariaPacket = require("./packet/Packet_ManaEffect.js");
let Packet_NpcRelease$TerrariaPacket = require("./packet/Packet_NpcRelease.js");
let Packet_PlayerInfo$TerrariaPacket = require("./packet/Packet_PlayerInfo.js");
let Packet_PlayerMana$TerrariaPacket = require("./packet/Packet_PlayerMana.js");
let Packet_TileModify$TerrariaPacket = require("./packet/Packet_TileModify.js");
let Packet_ObjectPlace$TerrariaPacket = require("./packet/Packet_ObjectPlace.js");
let Packet_PlayerDeath$TerrariaPacket = require("./packet/Packet_PlayerDeath.js");
let Packet_PlayerSpawn$TerrariaPacket = require("./packet/Packet_PlayerSpawn.js");
let Packet_PlayerActive$TerrariaPacket = require("./packet/Packet_PlayerActive.js");
let Packet_PlayerDamage$TerrariaPacket = require("./packet/Packet_PlayerDamage.js");
let Packet_PlayerHealth$TerrariaPacket = require("./packet/Packet_PlayerHealth.js");
let Packet_PlayerUpdate$TerrariaPacket = require("./packet/Packet_PlayerUpdate.js");
let Packet_LoadoutSwitch$TerrariaPacket = require("./packet/Packet_LoadoutSwitch.js");
let Packet_NetModuleLoad$TerrariaPacket = require("./packet/Packet_NetModuleLoad.js");
let Packet_NpcBuffUpdate$TerrariaPacket = require("./packet/Packet_NpcBuffUpdate.js");
let Packet_PlayerBuffAdd$TerrariaPacket = require("./packet/Packet_PlayerBuffAdd.js");
let Packet_PlayerSlotSet$TerrariaPacket = require("./packet/Packet_PlayerSlotSet.js");
let Packet_ConnectRequest$TerrariaPacket = require("./packet/Packet_ConnectRequest.js");
let Packet_ExtraValueSync$TerrariaPacket = require("./packet/Packet_ExtraValueSync.js");
let Packet_ItemDropUpdate$TerrariaPacket = require("./packet/Packet_ItemDropUpdate.js");
let Packet_ItemFramePlace$TerrariaPacket = require("./packet/Packet_ItemFramePlace.js");
let Packet_LucyAxeMessage$TerrariaPacket = require("./packet/Packet_LucyAxeMessage.js");
let Packet_PlayerBuffsSet$TerrariaPacket = require("./packet/Packet_PlayerBuffsSet.js");
let Packet_ProjectileSync$TerrariaPacket = require("./packet/Packet_ProjectileSync.js");
let Packet_TileSquareSend$TerrariaPacket = require("./packet/Packet_TileSquareSend.js");
let Packet_ItemOwnerRemove$TerrariaPacket = require("./packet/Packet_ItemOwnerRemove.js");
let Packet_TileSectionSend$TerrariaPacket = require("./packet/Packet_TileSectionSend.js");
let Packet_ChatMessageSmart$TerrariaPacket = require("./packet/Packet_ChatMessageSmart.js");
let Packet_DimensionsUpdate$TerrariaPacket = require("./packet/Packet_DimensionsUpdate.js");
let Packet_TileSectionFrame$TerrariaPacket = require("./packet/Packet_TileSectionFrame.js");
let Packet_MoonLordCountdown$TerrariaPacket = require("./packet/Packet_MoonLordCountdown.js");
let Packet_ProjectileDestroy$TerrariaPacket = require("./packet/Packet_ProjectileDestroy.js");
let Packet_ActiveContainerSync$TerrariaPacket = require("./packet/Packet_ActiveContainerSync.js");
let Packet_BossOrInvasionSpawn$TerrariaPacket = require("./packet/Packet_BossOrInvasionSpawn.js");
let Packet_ChestOrTempleUnlock$TerrariaPacket = require("./packet/Packet_ChestOrTempleUnlock.js");
let Packet_PlayerInventorySlot$TerrariaPacket = require("./packet/Packet_PlayerInventorySlot.js");
let Packet_TeleportationPotion$TerrariaPacket = require("./packet/Packet_TeleportationPotion.js");
let Packet_CrystalInvasionStart$TerrariaPacket = require("./packet/Packet_CrystalInvasionStart.js");
let Packet_PlayerTeleportPortal$TerrariaPacket = require("./packet/Packet_PlayerTeleportPortal.js");
let Packet_FoodPlatterTryPlacing$TerrariaPacket = require("./packet/Packet_FoodPlatterTryPlacing.js");
let Packet_WeaponsRackTryPlacing$TerrariaPacket = require("./packet/Packet_WeaponsRackTryPlacing.js");
let Packet_CreditsOrSlimeTransform$TerrariaPacket = require("./packet/Packet_CreditsOrSlimeTransform.js");
let Packet_ItemDropInstancedUpdate$TerrariaPacket = require("./packet/Packet_ItemDropInstancedUpdate.js");
let Packet_ItemDropProtectedUpdate$TerrariaPacket = require("./packet/Packet_ItemDropProtectedUpdate.js");
let Packet_ItemDropShimmeredUpdate$TerrariaPacket = require("./packet/Packet_ItemDropShimmeredUpdate.js");
let Packet_PiggyBankVoidLensUpdate$TerrariaPacket = require("./packet/Packet_PiggyBankVoidLensUpdate.js");
let Packet_PlayerLuckFactorsUpdate$TerrariaPacket = require("./packet/Packet_PlayerLuckFactorsUpdate.js");
let Packet_ShimmerEffectOrCoinLuck$TerrariaPacket = require("./packet/Packet_ShimmerEffectOrCoinLuck.js");
let Packet_TileEntityHatRackItemSync$TerrariaPacket = require("./packet/Packet_TileEntityHatRackItemSync.js");
let Packet_InitialTileSectionsRequest$TerrariaPacket = require("./packet/Packet_InitialTileSectionsRequest.js");
let Packet_HaveDryadDoStardewAnimation$TerrariaPacket = require("./packet/Packet_HaveDryadDoStardewAnimation.js");
let Packet_TravellingMerchantInventory$TerrariaPacket = require("./packet/Packet_TravellingMerchantInventory.js");
let Packet_TileEntityDisplayDollItemSync$TerrariaPacket = require("./packet/Packet_TileEntityDisplayDollItemSync.js");
let Packet_DungeonDefendersEventAttemptSkipWait$TerrariaPacket = require("./packet/Packet_DungeonDefendersEventAttemptSkipWait.js");

function mapPacket(buffer, fn) {
  return Stdlib_Result.mapError(Stdlib_Result.map(buffer, fn), e => ({
    TAG: "ReaderError",
    _0: e
  }));
}

function parsePayload(packetType, payload, fromServer) {
  switch (packetType) {
    case "ConnectRequest" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "ConnectRequestFromServer"
        };
      } else {
        return mapPacket(Packet_ConnectRequest$TerrariaPacket.parse(payload), a => ({
          TAG: "ConnectRequest",
          _0: a
        }));
      }
    case "Disconnect" :
      if (fromServer) {
        return mapPacket(Packet_Disconnect$TerrariaPacket.parse(payload), a => ({
          TAG: "Disconnect",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "DisconnectFromClient"
        };
      }
    case "PlayerSlotSet" :
      if (fromServer) {
        return mapPacket(Packet_PlayerSlotSet$TerrariaPacket.parse(payload), a => ({
          TAG: "PlayerSlotSet",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "PlayerSlotSetFromClient"
        };
      }
    case "PlayerInfo" :
      return mapPacket(Packet_PlayerInfo$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerInfo",
        _0: a
      }));
    case "PlayerInventorySlot" :
      return mapPacket(Packet_PlayerInventorySlot$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerInventorySlot",
        _0: a
      }));
    case "WorldDataRequest" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "WorldDataRequestFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "WorldInfo" :
      if (fromServer) {
        return mapPacket(Packet_WorldInfo$TerrariaPacket.parse(payload), a => ({
          TAG: "WorldInfo",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "WorldInfoFromClient"
        };
      }
    case "InitialTileSectionsRequest" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "InitialTileSectionsRequestFromServer"
        };
      } else {
        return mapPacket(Packet_InitialTileSectionsRequest$TerrariaPacket.parse(payload), a => ({
          TAG: "InitialTileSectionsRequest",
          _0: a
        }));
      }
    case "Status" :
      if (fromServer) {
        return mapPacket(Packet_Status$TerrariaPacket.parse(payload), a => ({
          TAG: "Status",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "StatusFromClient"
        };
      }
    case "TileSectionSend" :
      if (fromServer) {
        return mapPacket(Packet_TileSectionSend$TerrariaPacket.parse(payload), a => ({
          TAG: "TileSectionSend",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "TileSectionSendFromClient"
        };
      }
    case "TileSectionFrame" :
      if (fromServer) {
        return mapPacket(Packet_TileSectionFrame$TerrariaPacket.parse(payload), a => ({
          TAG: "TileSectionFrame",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "TileSectionFrameFromClient"
        };
      }
    case "PlayerSpawn" :
      return mapPacket(Packet_PlayerSpawn$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerSpawn",
        _0: a
      }));
    case "PlayerUpdate" :
      return mapPacket(Packet_PlayerUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerUpdate",
        _0: a
      }));
    case "PlayerActive" :
      if (fromServer) {
        return mapPacket(Packet_PlayerActive$TerrariaPacket.parse(payload), a => ({
          TAG: "PlayerActive",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "PlayerActiveFromClient"
        };
      }
    case "PlayerHealth" :
      return mapPacket(Packet_PlayerHealth$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerHealth",
        _0: a
      }));
    case "TileModify" :
      return mapPacket(Packet_TileModify$TerrariaPacket.parse(payload), a => ({
        TAG: "TileModify",
        _0: a
      }));
    case "TimeSet" :
      if (fromServer) {
        return mapPacket(Packet_TimeSet$TerrariaPacket.parse(payload), a => ({
          TAG: "TimeSet",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "TimeSetFromClient"
        };
      }
    case "TileSquareSend" :
      return mapPacket(Packet_TileSquareSend$TerrariaPacket.parse(payload), a => ({
        TAG: "TileSquareSend",
        _0: a
      }));
    case "ItemDropUpdate" :
      return mapPacket(Packet_ItemDropUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "ItemDropUpdate",
        _0: a
      }));
    case "ItemOwner" :
      return mapPacket(Packet_ItemOwner$TerrariaPacket.parse(payload), a => ({
        TAG: "ItemOwner",
        _0: a
      }));
    case "NpcUpdate" :
      if (fromServer) {
        return mapPacket(Packet_NpcUpdate$TerrariaPacket.parse(payload), a => ({
          TAG: "NpcUpdate",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "NpcUpdateFromClient"
        };
      }
    case "ProjectileSync" :
      return mapPacket(Packet_ProjectileSync$TerrariaPacket.parse(payload), a => ({
        TAG: "ProjectileSync",
        _0: a
      }));
    case "ProjectileDestroy" :
      return mapPacket(Packet_ProjectileDestroy$TerrariaPacket.parse(payload), a => ({
        TAG: "ProjectileDestroy",
        _0: a
      }));
    case "PvpToggle" :
      return mapPacket(Packet_PvpToggle$TerrariaPacket.parse(payload), a => ({
        TAG: "PvpToggle",
        _0: a
      }));
    case "ChestOpen" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "ChestOpenFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "ChestItem" :
      return mapPacket(Packet_ChestItem$TerrariaPacket.parse(payload), a => ({
        TAG: "ChestItem",
        _0: a
      }));
    case "ActiveContainerSync" :
      return mapPacket(Packet_ActiveContainerSync$TerrariaPacket.parse(payload), a => ({
        TAG: "ActiveContainerSync",
        _0: a
      }));
    case "ChestPlace" :
      return mapPacket(Packet_ChestPlace$TerrariaPacket.parse(payload), a => ({
        TAG: "ChestPlace",
        _0: a
      }));
    case "HealEffect" :
      return mapPacket(Packet_HealEffect$TerrariaPacket.parse(payload), a => ({
        TAG: "HealEffect",
        _0: a
      }));
    case "PasswordRequired" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "PasswordRequiredFromClient"
        };
      }
    case "PasswordSend" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "PasswordSendFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "ItemOwnerRemove" :
      if (fromServer) {
        return mapPacket(Packet_ItemOwnerRemove$TerrariaPacket.parse(payload), a => ({
          TAG: "ItemOwnerRemove",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "ItemOwnerRemoveFromClient"
        };
      }
    case "PlayerMana" :
      return mapPacket(Packet_PlayerMana$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerMana",
        _0: a
      }));
    case "ManaEffect" :
      return mapPacket(Packet_ManaEffect$TerrariaPacket.parse(payload), a => ({
        TAG: "ManaEffect",
        _0: a
      }));
    case "SignRead" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "SignReadFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "PlayerSpawnSelf" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "PlayerSpawnSelfFromClient"
        };
      }
    case "PlayerBuffsSet" :
      return mapPacket(Packet_PlayerBuffsSet$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerBuffsSet",
        _0: a
      }));
    case "ChestOrTempleUnlock" :
      return mapPacket(Packet_ChestOrTempleUnlock$TerrariaPacket.parse(payload), a => ({
        TAG: "ChestOrTempleUnlock",
        _0: a
      }));
    case "NpcBuffUpdate" :
      if (fromServer) {
        return mapPacket(Packet_NpcBuffUpdate$TerrariaPacket.parse(payload), a => ({
          TAG: "NpcBuffUpdate",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "NpcBuffUpdateFromClient"
        };
      }
    case "PlayerBuffAdd" :
      return mapPacket(Packet_PlayerBuffAdd$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerBuffAdd",
        _0: a
      }));
    case "GoodEvilUpdate" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "GoodEvilUpdateFromClient"
        };
      }
    case "BossOrInvasionSpawn" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "BossOrInvasionSpawnFromServer"
        };
      } else {
        return mapPacket(Packet_BossOrInvasionSpawn$TerrariaPacket.parse(payload), a => ({
          TAG: "BossOrInvasionSpawn",
          _0: a
        }));
      }
    case "TilePaint" :
      return mapPacket(Packet_TilePaint$TerrariaPacket.parse(payload), a => ({
        TAG: "TilePaint",
        _0: a
      }));
    case "WallPaint" :
      return mapPacket(Packet_WallPaint$TerrariaPacket.parse(payload), a => ({
        TAG: "WallPaint",
        _0: a
      }));
    case "Teleport" :
      return mapPacket(Packet_Teleport$TerrariaPacket.parse(payload), a => ({
        TAG: "Teleport",
        _0: a
      }));
    case "DimensionsUpdate" :
      return mapPacket(Packet_DimensionsUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "DimensionsUpdate",
        _0: a
      }));
    case "ClientUuid" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "ClientUuidFromServer"
        };
      } else {
        return mapPacket(Packet_ClientUuid$TerrariaPacket.parse(payload), a => ({
          TAG: "ClientUuid",
          _0: a
        }));
      }
    case "NpcCatch" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NpcCatchFromServer"
        };
      } else {
        return mapPacket(Packet_NpcCatch$TerrariaPacket.parse(payload), a => ({
          TAG: "NpcCatch",
          _0: a
        }));
      }
    case "NpcRelease" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NpcReleaseFromServer"
        };
      } else {
        return mapPacket(Packet_NpcRelease$TerrariaPacket.parse(payload), a => ({
          TAG: "NpcRelease",
          _0: a
        }));
      }
    case "TravellingMerchantInventory" :
      if (fromServer) {
        return mapPacket(Packet_TravellingMerchantInventory$TerrariaPacket.parse(payload), a => ({
          TAG: "TravellingMerchantInventory",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "TravellingMerchantInventoryFromClient"
        };
      }
    case "TeleportationPotion" :
      return mapPacket(Packet_TeleportationPotion$TerrariaPacket.parse(payload), a => ({
        TAG: "TeleportationPotion",
        _0: a
      }));
    case "AnglerQuest" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "AnglerQuestFromClient"
        };
      }
    case "AnglerQuestComplete" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "AnglerQuestCompleteFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "TemporaryAnimationCreate" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "TemporaryAnimationCreateFromClient"
        };
      }
    case "InvasionProgressReport" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "InvasionProgressReportFromClient"
        };
      }
    case "ObjectPlace" :
      return mapPacket(Packet_ObjectPlace$TerrariaPacket.parse(payload), a => ({
        TAG: "ObjectPlace",
        _0: a
      }));
    case "PlayerChestIndexSync" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "PlayerChestIndexSyncFromClient"
        };
      }
    case "CombatNumberCreate" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "CombatNumberCreateFromClient"
        };
      }
    case "NetModuleLoad" :
      return mapPacket(Packet_NetModuleLoad$TerrariaPacket.parse(payload, fromServer), a => ({
        TAG: "NetModuleLoad",
        _0: a
      }));
    case "NpcKillCount" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NpcKillCountFromClient"
        };
      }
    case "ItemForceIntoNearestChest" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "ItemForceIntoNearestChestFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "TileEntityUpdate" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "TileEntityUpdateFromClient"
        };
      }
    case "TileEntityPlace" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "TileEntityPlaceFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "ItemDropModify" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "ItemDropModifyFromClient"
        };
      }
    case "ItemFramePlace" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "ItemFramePlaceFromServer"
        };
      } else {
        return mapPacket(Packet_ItemFramePlace$TerrariaPacket.parse(payload), a => ({
          TAG: "ItemFramePlace",
          _0: a
        }));
      }
    case "ItemDropInstancedUpdate" :
      return mapPacket(Packet_ItemDropInstancedUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "ItemDropInstancedUpdate",
        _0: a
      }));
    case "EmoteBubble" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "EmoteBubbleFromClient"
        };
      }
    case "ExtraValueSync" :
      return mapPacket(Packet_ExtraValueSync$TerrariaPacket.parse(payload), a => ({
        TAG: "ExtraValueSync",
        _0: a
      }));
    case "PortalKill" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "PortalKillFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "PlayerTeleportPortal" :
      return mapPacket(Packet_PlayerTeleportPortal$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerTeleportPortal",
        _0: a
      }));
    case "NpcKilledNotification" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NpcKilledNotificationFromClient"
        };
      }
    case "EventNotification" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "EventNotificationFromClient"
        };
      }
    case "ShieldStrengthsUpdate" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "ShieldStrengthsUpdateFromClient"
        };
      }
    case "MoonLordCountdown" :
      if (fromServer) {
        return mapPacket(Packet_MoonLordCountdown$TerrariaPacket.parse(payload), a => ({
          TAG: "MoonLordCountdown",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "MoonLordCountdownFromClient"
        };
      }
    case "NpcShopItem" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NpcShopItemFromClient"
        };
      }
    case "GemLockToggle" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "GemLockToggleFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "SmokePoof" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "SmokePoofFromClient"
        };
      }
    case "ChatMessageSmart" :
      if (fromServer) {
        return mapPacket(Packet_ChatMessageSmart$TerrariaPacket.parse(payload), a => ({
          TAG: "ChatMessageSmart",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "ChatMessageSmartFromClient"
        };
      }
    case "WiredCannonShot" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "WiredCannonShotFromClient"
        };
      }
    case "MassWireOperation" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "MassWireOperationFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "MassWireOperationPay" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "MassWireOperationPayFromClient"
        };
      }
    case "PartyToggle" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "PartyToggleFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "CrystalInvasionStart" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "CrystalInvasionStartFromServer"
        };
      } else {
        return mapPacket(Packet_CrystalInvasionStart$TerrariaPacket.parse(payload), a => ({
          TAG: "CrystalInvasionStart",
          _0: a
        }));
      }
    case "CrystalInvasionWipeAll" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "CrystalInvasionWipeAllFromClient"
        };
      }
    case "CrystalInvasionSendWaitTime" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "CrystalInvasionSendWaitTimeFromClient"
        };
      }
    case "PlayerDamage" :
      return mapPacket(Packet_PlayerDamage$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerDamage",
        _0: a
      }));
    case "PlayerDeath" :
      return mapPacket(Packet_PlayerDeath$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerDeath",
        _0: a
      }));
    case "CombatTextCreate" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "CombatTextCreateFromClient"
        };
      }
    case "Emoji" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "EmojiFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "TileEntityDisplayDollItemSync" :
      return mapPacket(Packet_TileEntityDisplayDollItemSync$TerrariaPacket.parse(payload), a => ({
        TAG: "TileEntityDisplayDollItemSync",
        _0: a
      }));
    case "WeaponsRackTryPlacing" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "WeaponsRackTryPlacingFromServer"
        };
      } else {
        return mapPacket(Packet_WeaponsRackTryPlacing$TerrariaPacket.parse(payload), a => ({
          TAG: "WeaponsRackTryPlacing",
          _0: a
        }));
      }
    case "TileEntityHatRackItemSync" :
      return mapPacket(Packet_TileEntityHatRackItemSync$TerrariaPacket.parse(payload), a => ({
        TAG: "TileEntityHatRackItemSync",
        _0: a
      }));
    case "RevengeMarkerSync" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "RevengeMarkerSyncFromClient"
        };
      }
    case "RevengeMarkerRemove" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "RevengeMarkerRemoveFromClient"
        };
      }
    case "ClientFinishConnectingToServer" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "ClientFinishConnectingToServerFromClient"
        };
      }
    case "NpcFishOut" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NpcFishOutFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "NpcTamper" :
      if (fromServer) {
        return mapPacket(Packet_NpcTamper$TerrariaPacket.parse(payload), a => ({
          TAG: "NpcTamper",
          _0: a
        }));
      } else {
        return {
          TAG: "Error",
          _0: "NpcTamperFromClient"
        };
      }
    case "LegacySoundPlay" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "LegacySoundPlayFromClient"
        };
      }
    case "FoodPlatterTryPlacing" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "FoodPlatterTryPlacingFromServer"
        };
      } else {
        return mapPacket(Packet_FoodPlatterTryPlacing$TerrariaPacket.parse(payload), a => ({
          TAG: "FoodPlatterTryPlacing",
          _0: a
        }));
      }
    case "PlayerLuckFactorsUpdate" :
      return mapPacket(Packet_PlayerLuckFactorsUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "PlayerLuckFactorsUpdate",
        _0: a
      }));
    case "PlayerDead" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      } else {
        return {
          TAG: "Error",
          _0: "PlayerDeadFromClient"
        };
      }
    case "NpcBuffRemovalRequest" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "NpcBuffRemovalRequestFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "ClientSyncedInventory" :
      if (fromServer) {
        return {
          TAG: "Error",
          _0: "ClientSyncedInventoryFromServer"
        };
      } else {
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
      }
    case "CreditsOrSlimeTransform" :
      return mapPacket(Packet_CreditsOrSlimeTransform$TerrariaPacket.parse(payload), a => ({
        TAG: "CreditsOrSlimeTransform",
        _0: a
      }));
    case "LucyAxeMessage" :
      return mapPacket(Packet_LucyAxeMessage$TerrariaPacket.parse(payload), a => ({
        TAG: "LucyAxeMessage",
        _0: a
      }));
    case "PiggyBankVoidLensUpdate" :
      return mapPacket(Packet_PiggyBankVoidLensUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "PiggyBankVoidLensUpdate",
        _0: a
      }));
    case "DungeonDefendersEventAttemptSkipWait" :
      return mapPacket(Packet_DungeonDefendersEventAttemptSkipWait$TerrariaPacket.parse(payload), a => ({
        TAG: "DungeonDefendersEventAttemptSkipWait",
        _0: a
      }));
    case "HaveDryadDoStardewAnimation" :
      return mapPacket(Packet_HaveDryadDoStardewAnimation$TerrariaPacket.parse(payload), a => ({
        TAG: "HaveDryadDoStardewAnimation",
        _0: a
      }));
    case "ItemDropShimmeredUpdate" :
      return mapPacket(Packet_ItemDropShimmeredUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "ItemDropShimmeredUpdate",
        _0: a
      }));
    case "ShimmerEffectOrCoinLuck" :
      return mapPacket(Packet_ShimmerEffectOrCoinLuck$TerrariaPacket.parse(payload), a => ({
        TAG: "ShimmerEffectOrCoinLuck",
        _0: a
      }));
    case "LoadoutSwitch" :
      return mapPacket(Packet_LoadoutSwitch$TerrariaPacket.parse(payload), a => ({
        TAG: "LoadoutSwitch",
        _0: a
      }));
    case "ItemDropProtectedUpdate" :
      return mapPacket(Packet_ItemDropProtectedUpdate$TerrariaPacket.parse(payload), a => ({
        TAG: "ItemDropProtectedUpdate",
        _0: a
      }));
    default:
      return {
        TAG: "Error",
        _0: "NotImplemented"
      };
  }
}

function parse(buffer, fromServer) {
  let match = buffer.length;
  if (!(match > 2 || match < 0)) {
    return {
      TAG: "Error",
      _0: "InvalidPacketLength"
    };
  }
  let packetType = PacketType$TerrariaPacket.fromInt(buffer[2]);
  if (packetType === undefined) {
    return {
      TAG: "Error",
      _0: "InvalidPacketType"
    };
  }
  try {
    return Stdlib_Result.map(parsePayload(packetType, buffer, fromServer), packet => ({
      TAG: "SerializeNotNecessary",
      _0: packet,
      _1: buffer
    }));
  } catch (raw_obj) {
    let obj = Primitive_exceptions.internalToException(raw_obj);
    if (obj.RE_EXN_ID === "JsExn") {
      return {
        TAG: "Error",
        _0: {
          TAG: "ReaderError",
          _0: {
            context: "Parser.parse",
            error: obj._1
          }
        }
      };
    }
    throw obj;
  }
}

function parseLazy(buffer, fromServer) {
  let match = buffer.length;
  if (!(match > 2 || match < 0)) {
    return {
      TAG: "Error",
      _0: "InvalidPacketLength"
    };
  }
  let packetType = PacketType$TerrariaPacket.fromInt(buffer[2]);
  if (packetType === undefined) {
    return {
      TAG: "Error",
      _0: "InvalidPacketType"
    };
  }
  try {
    switch (packetType) {
      case "ConnectRequest" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "ConnectRequestFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "ConnectRequest",
              _0: Stdlib_Lazy.make(() => Packet_ConnectRequest$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "Disconnect" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "Disconnect",
              _0: Stdlib_Lazy.make(() => Packet_Disconnect$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "DisconnectFromClient"
          };
        }
      case "PlayerSlotSet" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "PlayerSlotSet",
              _0: Stdlib_Lazy.make(() => Packet_PlayerSlotSet$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "PlayerSlotSetFromClient"
          };
        }
      case "PlayerInfo" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerInfo",
            _0: Stdlib_Lazy.make(() => Packet_PlayerInfo$TerrariaPacket.parse(buffer))
          }
        };
      case "PlayerInventorySlot" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerInventorySlot",
            _0: Stdlib_Lazy.make(() => Packet_PlayerInventorySlot$TerrariaPacket.parse(buffer))
          }
        };
      case "WorldDataRequest" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "WorldDataRequestFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "WorldInfo" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "WorldInfo",
              _0: Stdlib_Lazy.make(() => Packet_WorldInfo$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "WorldInfoFromClient"
          };
        }
      case "InitialTileSectionsRequest" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "InitialTileSectionsRequestFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "InitialTileSectionsRequest",
              _0: Stdlib_Lazy.make(() => Packet_InitialTileSectionsRequest$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "Status" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "Status",
              _0: Stdlib_Lazy.make(() => Packet_Status$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "StatusFromClient"
          };
        }
      case "TileSectionSend" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "TileSectionSend",
              _0: Stdlib_Lazy.make(() => Packet_TileSectionSend$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "TileSectionSendFromClient"
          };
        }
      case "TileSectionFrame" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "TileSectionFrame",
              _0: Stdlib_Lazy.make(() => Packet_TileSectionFrame$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "TileSectionFrameFromClient"
          };
        }
      case "PlayerSpawn" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerSpawn",
            _0: Stdlib_Lazy.make(() => Packet_PlayerSpawn$TerrariaPacket.parse(buffer))
          }
        };
      case "PlayerUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerUpdate",
            _0: Stdlib_Lazy.make(() => Packet_PlayerUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "PlayerActive" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "PlayerActive",
              _0: Stdlib_Lazy.make(() => Packet_PlayerActive$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "PlayerActiveFromClient"
          };
        }
      case "PlayerHealth" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerHealth",
            _0: Stdlib_Lazy.make(() => Packet_PlayerHealth$TerrariaPacket.parse(buffer))
          }
        };
      case "TileModify" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "TileModify",
            _0: Stdlib_Lazy.make(() => Packet_TileModify$TerrariaPacket.parse(buffer))
          }
        };
      case "TimeSet" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "TimeSet",
              _0: Stdlib_Lazy.make(() => Packet_TimeSet$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "TimeSetFromClient"
          };
        }
      case "TileSquareSend" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "TileSquareSend",
            _0: Stdlib_Lazy.make(() => Packet_TileSquareSend$TerrariaPacket.parse(buffer))
          }
        };
      case "ItemDropUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ItemDropUpdate",
            _0: Stdlib_Lazy.make(() => Packet_ItemDropUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "ItemOwner" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ItemOwner",
            _0: Stdlib_Lazy.make(() => Packet_ItemOwner$TerrariaPacket.parse(buffer))
          }
        };
      case "NpcUpdate" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "NpcUpdate",
              _0: Stdlib_Lazy.make(() => Packet_NpcUpdate$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "NpcUpdateFromClient"
          };
        }
      case "ProjectileSync" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ProjectileSync",
            _0: Stdlib_Lazy.make(() => Packet_ProjectileSync$TerrariaPacket.parse(buffer))
          }
        };
      case "ProjectileDestroy" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ProjectileDestroy",
            _0: Stdlib_Lazy.make(() => Packet_ProjectileDestroy$TerrariaPacket.parse(buffer))
          }
        };
      case "PvpToggle" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PvpToggle",
            _0: Stdlib_Lazy.make(() => Packet_PvpToggle$TerrariaPacket.parse(buffer))
          }
        };
      case "ChestOpen" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "ChestOpenFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "ChestItem" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ChestItem",
            _0: Stdlib_Lazy.make(() => Packet_ChestItem$TerrariaPacket.parse(buffer))
          }
        };
      case "ActiveContainerSync" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ActiveContainerSync",
            _0: Stdlib_Lazy.make(() => Packet_ActiveContainerSync$TerrariaPacket.parse(buffer))
          }
        };
      case "ChestPlace" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ChestPlace",
            _0: Stdlib_Lazy.make(() => Packet_ChestPlace$TerrariaPacket.parse(buffer))
          }
        };
      case "HealEffect" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "HealEffect",
            _0: Stdlib_Lazy.make(() => Packet_HealEffect$TerrariaPacket.parse(buffer))
          }
        };
      case "PasswordRequired" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "PasswordRequiredFromClient"
          };
        }
      case "PasswordSend" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "PasswordSendFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "ItemOwnerRemove" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "ItemOwnerRemove",
              _0: Stdlib_Lazy.make(() => Packet_ItemOwnerRemove$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "ItemOwnerRemoveFromClient"
          };
        }
      case "PlayerMana" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerMana",
            _0: Stdlib_Lazy.make(() => Packet_PlayerMana$TerrariaPacket.parse(buffer))
          }
        };
      case "ManaEffect" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ManaEffect",
            _0: Stdlib_Lazy.make(() => Packet_ManaEffect$TerrariaPacket.parse(buffer))
          }
        };
      case "SignRead" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "SignReadFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "PlayerSpawnSelf" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "PlayerSpawnSelfFromClient"
          };
        }
      case "PlayerBuffsSet" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerBuffsSet",
            _0: Stdlib_Lazy.make(() => Packet_PlayerBuffsSet$TerrariaPacket.parse(buffer))
          }
        };
      case "ChestOrTempleUnlock" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ChestOrTempleUnlock",
            _0: Stdlib_Lazy.make(() => Packet_ChestOrTempleUnlock$TerrariaPacket.parse(buffer))
          }
        };
      case "NpcBuffUpdate" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "NpcBuffUpdate",
              _0: Stdlib_Lazy.make(() => Packet_NpcBuffUpdate$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "NpcBuffUpdateFromClient"
          };
        }
      case "PlayerBuffAdd" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerBuffAdd",
            _0: Stdlib_Lazy.make(() => Packet_PlayerBuffAdd$TerrariaPacket.parse(buffer))
          }
        };
      case "GoodEvilUpdate" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "GoodEvilUpdateFromClient"
          };
        }
      case "BossOrInvasionSpawn" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "BossOrInvasionSpawnFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "BossOrInvasionSpawn",
              _0: Stdlib_Lazy.make(() => Packet_BossOrInvasionSpawn$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "TilePaint" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "TilePaint",
            _0: Stdlib_Lazy.make(() => Packet_TilePaint$TerrariaPacket.parse(buffer))
          }
        };
      case "WallPaint" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "WallPaint",
            _0: Stdlib_Lazy.make(() => Packet_WallPaint$TerrariaPacket.parse(buffer))
          }
        };
      case "Teleport" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "Teleport",
            _0: Stdlib_Lazy.make(() => Packet_Teleport$TerrariaPacket.parse(buffer))
          }
        };
      case "DimensionsUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "DimensionsUpdate",
            _0: Stdlib_Lazy.make(() => Packet_DimensionsUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "ClientUuid" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "ClientUuidFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "ClientUuid",
              _0: Stdlib_Lazy.make(() => Packet_ClientUuid$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "NpcCatch" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NpcCatchFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "NpcCatch",
              _0: Stdlib_Lazy.make(() => Packet_NpcCatch$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "NpcRelease" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NpcReleaseFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "NpcRelease",
              _0: Stdlib_Lazy.make(() => Packet_NpcRelease$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "TravellingMerchantInventory" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "TravellingMerchantInventory",
              _0: Stdlib_Lazy.make(() => Packet_TravellingMerchantInventory$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "TravellingMerchantInventoryFromClient"
          };
        }
      case "TeleportationPotion" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "TeleportationPotion",
            _0: Stdlib_Lazy.make(() => Packet_TeleportationPotion$TerrariaPacket.parse(buffer))
          }
        };
      case "AnglerQuest" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "AnglerQuestFromClient"
          };
        }
      case "AnglerQuestComplete" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "AnglerQuestCompleteFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "TemporaryAnimationCreate" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "TemporaryAnimationCreateFromClient"
          };
        }
      case "InvasionProgressReport" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "InvasionProgressReportFromClient"
          };
        }
      case "ObjectPlace" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ObjectPlace",
            _0: Stdlib_Lazy.make(() => Packet_ObjectPlace$TerrariaPacket.parse(buffer))
          }
        };
      case "PlayerChestIndexSync" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "PlayerChestIndexSyncFromClient"
          };
        }
      case "CombatNumberCreate" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "CombatNumberCreateFromClient"
          };
        }
      case "NetModuleLoad" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "NetModuleLoad",
            _0: Stdlib_Lazy.make(() => Packet_NetModuleLoad$TerrariaPacket.parse(buffer, fromServer))
          }
        };
      case "NpcKillCount" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NpcKillCountFromClient"
          };
        }
      case "ItemForceIntoNearestChest" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "ItemForceIntoNearestChestFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "TileEntityUpdate" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "TileEntityUpdateFromClient"
          };
        }
      case "TileEntityPlace" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "TileEntityPlaceFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "ItemDropModify" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "ItemDropModifyFromClient"
          };
        }
      case "ItemFramePlace" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "ItemFramePlaceFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "ItemFramePlace",
              _0: Stdlib_Lazy.make(() => Packet_ItemFramePlace$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "ItemDropInstancedUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ItemDropInstancedUpdate",
            _0: Stdlib_Lazy.make(() => Packet_ItemDropInstancedUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "EmoteBubble" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "EmoteBubbleFromClient"
          };
        }
      case "ExtraValueSync" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ExtraValueSync",
            _0: Stdlib_Lazy.make(() => Packet_ExtraValueSync$TerrariaPacket.parse(buffer))
          }
        };
      case "PortalKill" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "PortalKillFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "PlayerTeleportPortal" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerTeleportPortal",
            _0: Stdlib_Lazy.make(() => Packet_PlayerTeleportPortal$TerrariaPacket.parse(buffer))
          }
        };
      case "NpcKilledNotification" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NpcKilledNotificationFromClient"
          };
        }
      case "EventNotification" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "EventNotificationFromClient"
          };
        }
      case "ShieldStrengthsUpdate" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "ShieldStrengthsUpdateFromClient"
          };
        }
      case "MoonLordCountdown" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "MoonLordCountdown",
              _0: Stdlib_Lazy.make(() => Packet_MoonLordCountdown$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "MoonLordCountdownFromClient"
          };
        }
      case "NpcShopItem" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NpcShopItemFromClient"
          };
        }
      case "GemLockToggle" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "GemLockToggleFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "SmokePoof" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "SmokePoofFromClient"
          };
        }
      case "ChatMessageSmart" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "ChatMessageSmart",
              _0: Stdlib_Lazy.make(() => Packet_ChatMessageSmart$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "ChatMessageSmartFromClient"
          };
        }
      case "WiredCannonShot" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "WiredCannonShotFromClient"
          };
        }
      case "MassWireOperation" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "MassWireOperationFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "MassWireOperationPay" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "MassWireOperationPayFromClient"
          };
        }
      case "PartyToggle" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "PartyToggleFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "CrystalInvasionStart" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "CrystalInvasionStartFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "CrystalInvasionStart",
              _0: Stdlib_Lazy.make(() => Packet_CrystalInvasionStart$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "CrystalInvasionWipeAll" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "CrystalInvasionWipeAllFromClient"
          };
        }
      case "CrystalInvasionSendWaitTime" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "CrystalInvasionSendWaitTimeFromClient"
          };
        }
      case "PlayerDamage" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerDamage",
            _0: Stdlib_Lazy.make(() => Packet_PlayerDamage$TerrariaPacket.parse(buffer))
          }
        };
      case "PlayerDeath" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerDeath",
            _0: Stdlib_Lazy.make(() => Packet_PlayerDeath$TerrariaPacket.parse(buffer))
          }
        };
      case "CombatTextCreate" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "CombatTextCreateFromClient"
          };
        }
      case "Emoji" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "EmojiFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "TileEntityDisplayDollItemSync" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "TileEntityDisplayDollItemSync",
            _0: Stdlib_Lazy.make(() => Packet_TileEntityDisplayDollItemSync$TerrariaPacket.parse(buffer))
          }
        };
      case "WeaponsRackTryPlacing" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "WeaponsRackTryPlacingFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "WeaponsRackTryPlacing",
              _0: Stdlib_Lazy.make(() => Packet_WeaponsRackTryPlacing$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "TileEntityHatRackItemSync" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "TileEntityHatRackItemSync",
            _0: Stdlib_Lazy.make(() => Packet_TileEntityHatRackItemSync$TerrariaPacket.parse(buffer))
          }
        };
      case "RevengeMarkerSync" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "RevengeMarkerSyncFromClient"
          };
        }
      case "RevengeMarkerRemove" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "RevengeMarkerRemoveFromClient"
          };
        }
      case "ClientFinishConnectingToServer" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "ClientFinishConnectingToServerFromClient"
          };
        }
      case "NpcFishOut" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NpcFishOutFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "NpcTamper" :
        if (fromServer) {
          return {
            TAG: "Ok",
            _0: {
              TAG: "NpcTamper",
              _0: Stdlib_Lazy.make(() => Packet_NpcTamper$TerrariaPacket.parse(buffer))
            }
          };
        } else {
          return {
            TAG: "Error",
            _0: "NpcTamperFromClient"
          };
        }
      case "LegacySoundPlay" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "LegacySoundPlayFromClient"
          };
        }
      case "FoodPlatterTryPlacing" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "FoodPlatterTryPlacingFromServer"
          };
        } else {
          return {
            TAG: "Ok",
            _0: {
              TAG: "FoodPlatterTryPlacing",
              _0: Stdlib_Lazy.make(() => Packet_FoodPlatterTryPlacing$TerrariaPacket.parse(buffer))
            }
          };
        }
      case "PlayerLuckFactorsUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PlayerLuckFactorsUpdate",
            _0: Stdlib_Lazy.make(() => Packet_PlayerLuckFactorsUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "PlayerDead" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        } else {
          return {
            TAG: "Error",
            _0: "PlayerDeadFromClient"
          };
        }
      case "NpcBuffRemovalRequest" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "NpcBuffRemovalRequestFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "ClientSyncedInventory" :
        if (fromServer) {
          return {
            TAG: "Error",
            _0: "ClientSyncedInventoryFromServer"
          };
        } else {
          return {
            TAG: "Error",
            _0: "NotImplemented"
          };
        }
      case "CreditsOrSlimeTransform" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "CreditsOrSlimeTransform",
            _0: Stdlib_Lazy.make(() => Packet_CreditsOrSlimeTransform$TerrariaPacket.parse(buffer))
          }
        };
      case "LucyAxeMessage" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "LucyAxeMessage",
            _0: Stdlib_Lazy.make(() => Packet_LucyAxeMessage$TerrariaPacket.parse(buffer))
          }
        };
      case "PiggyBankVoidLensUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "PiggyBankVoidLensUpdate",
            _0: Stdlib_Lazy.make(() => Packet_PiggyBankVoidLensUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "DungeonDefendersEventAttemptSkipWait" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "DungeonDefendersEventAttemptSkipWait",
            _0: Stdlib_Lazy.make(() => Packet_DungeonDefendersEventAttemptSkipWait$TerrariaPacket.parse(buffer))
          }
        };
      case "HaveDryadDoStardewAnimation" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "HaveDryadDoStardewAnimation",
            _0: Stdlib_Lazy.make(() => Packet_HaveDryadDoStardewAnimation$TerrariaPacket.parse(buffer))
          }
        };
      case "ItemDropShimmeredUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ItemDropShimmeredUpdate",
            _0: Stdlib_Lazy.make(() => Packet_ItemDropShimmeredUpdate$TerrariaPacket.parse(buffer))
          }
        };
      case "ShimmerEffectOrCoinLuck" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ShimmerEffectOrCoinLuck",
            _0: Stdlib_Lazy.make(() => Packet_ShimmerEffectOrCoinLuck$TerrariaPacket.parse(buffer))
          }
        };
      case "LoadoutSwitch" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "LoadoutSwitch",
            _0: Stdlib_Lazy.make(() => Packet_LoadoutSwitch$TerrariaPacket.parse(buffer))
          }
        };
      case "ItemDropProtectedUpdate" :
        return {
          TAG: "Ok",
          _0: {
            TAG: "ItemDropProtectedUpdate",
            _0: Stdlib_Lazy.make(() => Packet_ItemDropProtectedUpdate$TerrariaPacket.parse(buffer))
          }
        };
      default:
        return {
          TAG: "Error",
          _0: "NotImplemented"
        };
    }
  } catch (raw_obj) {
    let obj = Primitive_exceptions.internalToException(raw_obj);
    if (obj.RE_EXN_ID === "JsExn") {
      return {
        TAG: "Error",
        _0: {
          TAG: "ReaderError",
          _0: {
            context: "Parser.parseLazy",
            error: obj._1
          }
        }
      };
    }
    throw obj;
  }
}

exports.parse = parse;
exports.parseLazy = parseLazy;
/* Packet_Status-TerrariaPacket Not a pure module */
