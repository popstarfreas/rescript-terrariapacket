// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

let Belt_Option = require("@rescript/runtime/lib/js/Belt_Option.js");
let BitFlags$TerrariaPacket = require("./BitFlags.js");

function otherFromByte(byte) {
  switch (byte) {
    case 0 :
      return "FallDamage";
    case 1 :
      return "Drowning";
    case 2 :
      return "Lava";
    case 3 :
      return "FallDamage2";
    case 4 :
      return "DemonAltar";
    case 5 :
      return "CompanionCube";
    case 6 :
      return "Suffocation";
    case 7 :
      return "Burning";
    case 8 :
      return "Poison";
    case 9 :
      return "Electrified";
    case 10 :
      return "WallOfFleshEscape";
    case 11 :
      return "WallOfFleshLicked";
    case 12 :
      return "ChaosState";
    case 13 :
      return "ChaosState2Male";
    case 14 :
      return "ChaosState3Female";
    default:
      return;
  }
}

function otherToByte(other) {
  switch (other) {
    case "FallDamage" :
      return 0;
    case "Drowning" :
      return 1;
    case "Lava" :
      return 2;
    case "FallDamage2" :
      return 3;
    case "DemonAltar" :
      return 4;
    case "CompanionCube" :
      return 5;
    case "Suffocation" :
      return 6;
    case "Burning" :
      return 7;
    case "Poison" :
      return 8;
    case "Electrified" :
      return 9;
    case "WallOfFleshEscape" :
      return 10;
    case "WallOfFleshLicked" :
      return 11;
    case "ChaosState" :
      return 12;
    case "ChaosState2Male" :
      return 13;
    case "ChaosState3Female" :
      return 14;
  }
}

function readDeathReason(reader) {
  let reasonType = BitFlags$TerrariaPacket.fromByte(reader.readByte());
  let killerPlayerId = BitFlags$TerrariaPacket.flag1(reasonType) ? reader.readInt16() : undefined;
  let killerNpcId = BitFlags$TerrariaPacket.flag2(reasonType) ? reader.readInt16() : undefined;
  let killerProjectileId = BitFlags$TerrariaPacket.flag3(reasonType) ? reader.readInt16() : undefined;
  let typeOfDeathOther = BitFlags$TerrariaPacket.flag4(reasonType) ? otherFromByte(reader.readByte()) : undefined;
  let projectileType = BitFlags$TerrariaPacket.flag5(reasonType) ? reader.readInt16() : undefined;
  let itemType = BitFlags$TerrariaPacket.flag6(reasonType) ? reader.readInt16() : undefined;
  let itemPrefix = BitFlags$TerrariaPacket.flag7(reasonType) ? reader.readByte() : undefined;
  let deathReason = BitFlags$TerrariaPacket.flag8(reasonType) ? reader.readString() : undefined;
  return {
    killerPlayerId: killerPlayerId,
    killerNpcId: killerNpcId,
    killerProjectileId: killerProjectileId,
    typeOfDeathOther: typeOfDeathOther,
    projectileType: projectileType,
    itemType: itemType,
    itemPrefix: itemPrefix,
    deathReason: deathReason
  };
}

function packFlags(writer, self) {
  let flags = BitFlags$TerrariaPacket.fromFlags(Belt_Option.isSome(self.killerPlayerId), Belt_Option.isSome(self.killerNpcId), Belt_Option.isSome(self.killerProjectileId), Belt_Option.isSome(self.typeOfDeathOther), Belt_Option.isSome(self.projectileType), Belt_Option.isSome(self.itemType), Belt_Option.isSome(self.itemPrefix), Belt_Option.isSome(self.deathReason));
  return writer.packByte(BitFlags$TerrariaPacket.toByte(flags));
}

function packKillerPlayerId(writer, self) {
  let killerPlayerId = self.killerPlayerId;
  if (killerPlayerId !== undefined) {
    return writer.packInt16(killerPlayerId);
  } else {
    return writer;
  }
}

function packKillerNpcId(writer, self) {
  let killerNpcId = self.killerNpcId;
  if (killerNpcId !== undefined) {
    return writer.packInt16(killerNpcId);
  } else {
    return writer;
  }
}

function packKillerProjectileId(writer, self) {
  let killerProjectileId = self.killerProjectileId;
  if (killerProjectileId !== undefined) {
    return writer.packInt16(killerProjectileId);
  } else {
    return writer;
  }
}

function packTypeOfDeathOther(writer, self) {
  let typeOfDeathOther = self.typeOfDeathOther;
  if (typeOfDeathOther !== undefined) {
    return writer.packByte(otherToByte(typeOfDeathOther));
  } else {
    return writer;
  }
}

function packProjectileType(writer, self) {
  let projectileType = self.projectileType;
  if (projectileType !== undefined) {
    return writer.packInt16(projectileType);
  } else {
    return writer;
  }
}

function packItemType(writer, self) {
  let itemType = self.itemType;
  if (itemType !== undefined) {
    return writer.packInt16(itemType);
  } else {
    return writer;
  }
}

function packItemPrefix(writer, self) {
  let itemPrefix = self.itemPrefix;
  if (itemPrefix !== undefined) {
    return writer.packByte(itemPrefix);
  } else {
    return writer;
  }
}

function pack(writer, self) {
  let writer$1 = packItemPrefix(packItemType(packProjectileType(packTypeOfDeathOther(packKillerProjectileId(packKillerNpcId(packKillerPlayerId(packFlags(writer, self), self), self), self), self), self), self), self);
  let deathReason = self.deathReason;
  if (deathReason !== undefined) {
    return writer$1.packString(deathReason);
  } else {
    return writer$1;
  }
}

let packDeathReason = pack;

exports.readDeathReason = readDeathReason;
exports.packDeathReason = packDeathReason;
/* No side effect */
